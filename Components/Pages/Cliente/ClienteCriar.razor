@page "/clientes/novo"
@inject ClienteDAO clienteDAO;
@inject NavigationManager NavigationManager;
@using AppWeb.Models

<PageTitle>Novo Cliente</PageTitle>


<div class="container-principal">
    <div class="header-pagina">
        <h1>adicionar novo cliente</h1>
        <span class="subtitulo">preencha as informações do novo cliente</span>
    </div>

    @* Se você usou MensagemStatus no bloco @code, exiba aqui *@
    @* @if (!string.IsNullOrEmpty(MensagemStatus)) { <div class="alert alert-warning">@MensagemStatus</div> } *@

    <div class="tabela-funcionarios" style="padding: 20px; margin-top: 30px;">

        <EditForm Model="@novoCliente" OnValidSubmit="@SalvarNovoCliente">
            <DataAnnotationsValidator />
            <ValidationSummary />

            <div class="form-group mb-3">
                <label for="nome">Nome:</label>
                <InputText id="nome" @bind-Value="novoCliente.Nome" class="form-control" />
                <ValidationMessage For="@(() => novoCliente.Nome)" />
            </div>

            <div class="form-group mb-3">
                <label for="telefone">Telefone:</label>
                <InputText id="telefone" @bind-Value="novoCliente.Telefone" class="form-control" />
                <ValidationMessage For="@(() => novoCliente.Telefone)" />
            </div>

            <div class="form-group mb-3">
                <label for="email">Email:</label>
                <InputText id="email" @bind-Value="novoCliente.Email" class="form-control" />
                <ValidationMessage For="@(() => novoCliente.Email)" />
            </div>

            <div class="form-group mb-3">
                <label for="cidade">Cidade:</label>
                <InputText id="cidade" @bind-Value="novoCliente.Cidade" class="form-control" />
            </div>

            <div class="form-group mb-3">
                <label for="estado">Estado:</label>
                <InputText id="estado" @bind-Value="novoCliente.Estado" class="form-control" />
            </div>

            <hr style="border-color: var(--cor-secundaria); margin-top: 20px;" />

            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button type="submit" class="btn btn-success">Cadastrar Cliente</button>
                <a href="/clientes" class="btn btn-secondary">Cancelar</a>
            </div>

        </EditForm>
    </div>
</div>

@code {
    private Cliente novoCliente = new Cliente();
    // Você pode adicionar uma variável para mostrar mensagens de erro
    // private string? MensagemStatus;

    private void SalvarNovoCliente()
    {
        try
        {
            clienteDAO.Inserir(novoCliente);
            NavigationManager.NavigateTo("/clientes");
        }
        catch (Exception)
        {
            // Se o DAO lançar exceção, você pode capturar e mostrar no MensagemStatus
            // Ex: MensagemStatus = ex.Message;
        }
    }
}